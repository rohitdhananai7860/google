<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Login</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Light gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        /* Custom styling for the Google Sign-In button container */
        .g_id_signin {
            display: flex;
            justify-content: center;
            margin-top: 1.5rem; /* Add some space above the button */
        }
        /* Styling for the user info container */
        #user-info {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1rem; /* Rounded corners */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* Soft shadow */
            text-align: center;
            max-width: 400px;
            width: 90%;
            margin: 1rem;
            display: none; /* Hidden by default */
        }
        #user-info img {
            border-radius: 50%; /* Circular image */
            margin-bottom: 1rem;
            border: 3px solid #4285F4; /* Google blue border */
        }
        #user-info h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 0.5rem;
        }
        #user-info p {
            font-size: 1rem;
            color: #555;
            margin-bottom: 0.5rem;
        }
        .login-container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1rem; /* Rounded corners */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* Soft shadow */
            text-align: center;
            max-width: 400px;
            width: 90%;
            margin: 1rem;
        }
        .login-container h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1.5rem;
        }
        .logout-button {
            background-color: #ea4335; /* Google Red */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
            cursor: pointer;
            border: none;
            margin-top: 1.5rem;
        }
        .logout-button:hover {
            background-color: #c5221f;
        }
    </style>
</head>
<body>
    <!-- Login Container -->
    <div id="login-container" class="login-container">
        <h1>Sign in with Google</h1>
        <!-- Google Sign-In Button -->
        <div id="g_id_onload"
             data-client_id="562346867798-5rdeg6dj69e10u3861qgui7dseala6af.apps.googleusercontent.com"
             data-callback="handleCredentialResponse"
             data-auto_prompt="false">
        </div>
        <div class="g_id_signin"
             data-type="standard"
             data-size="large"
             data-theme="outline"
             data-text="sign_in_with"
             data-shape="rectangular"
             data-logo_alignment="left">
        </div>
    </div>

    <!-- User Info Display (hidden by default) -->
    <div id="user-info">
        <img id="profile-picture" src="" alt="Profile Picture" width="100" height="100">
        <h2 id="user-name"></h2>
        <p id="user-email"></p>
        <button id="signout-button" class="logout-button">Sign Out</button>
    </div>

    <!-- Google Identity Services JavaScript SDK -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
        // Function to handle the Google credential response
        function handleCredentialResponse(response) {
            // Decode the JWT token to get user information
            const decodedToken = parseJwt(response.credential);

            // Get references to the HTML elements
            const loginContainer = document.getElementById('login-container');
            const userInfoDiv = document.getElementById('user-info');
            const profilePicture = document.getElementById('profile-picture');
            const userName = document.getElementById('user-name');
            const userEmail = document.getElementById('user-email');

            // Update the user info display
            profilePicture.src = decodedToken.picture;
            userName.textContent = decodedToken.name;
            userEmail.textContent = decodedToken.email;

            // Hide the login container and show the user info
            loginContainer.style.display = 'none';
            userInfoDiv.style.display = 'block';
        }

        // Helper function to parse JWT token
        function parseJwt(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
                return JSON.parse(jsonPayload);
            } catch (e) {
                console.error("Error parsing JWT token:", e);
                return {};
            }
        }

        // Function to handle sign out
        document.getElementById('signout-button').addEventListener('click', () => {
            // Google Identity Services sign-out
            google.accounts.id.disableAutoSelect(); // Disables auto-login for subsequent visits
            google.accounts.id.revoke(localStorage.getItem('google_id_token'), done => {
                console.log('consent revoked', done);
                // Clear user info and show login container
                document.getElementById('profile-picture').src = '';
                document.getElementById('user-name').textContent = '';
                document.getElementById('user-email').textContent = '';

                document.getElementById('login-container').style.display = 'block';
                document.getElementById('user-info').style.display = 'none';

                // You might also want to clear any local storage or session data related to the user
                localStorage.removeItem('google_id_token');
            });
        });

        // Store the credential in local storage for demonstration (optional, for persistent login)
        // In a real application, you'd send this credential to your backend for verification.
        window.handleCredentialResponse = handleCredentialResponse; // Make it globally accessible for Google's callback
    </script>
</body>
</html>
